<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éû„É´„ÉÅ„Çµ„Éº„Éê„ÉºFTPÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            max-height: 85vh;
            overflow-y: auto;
        }

        .content {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .server-list {
            margin-bottom: 20px;
        }

        .server-item {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .server-item:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }

        .server-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .server-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .server-info {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .server-status {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #dc3545;
        }

        .server-status.connected {
            background: #28a745;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
        }

        .add-server-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .add-server-btn:hover {
            transform: scale(1.05);
        }

        .server-form {
            display: none;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .server-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 0.95em;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .file-type-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .file-type-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .file-type-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            margin-right: 10px;
        }

        .csv-icon {
            background: #28a745;
            color: white;
        }

        .html-icon {
            background: #fd7e14;
            color: white;
        }

        .file-type-title {
            font-size: 1.2em;
            font-weight: bold;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
        }

        .checkbox-group label {
            cursor: pointer;
            user-select: none;
        }

        .upload-area {
            background: #f8f9fa;
            border: 3px dashed #dee2e6;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: #f0f3ff;
        }

        .upload-area.dragover {
            border-color: #667eea;
            background: #e8ecff;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .file-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .file-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            margin-right: 15px;
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .file-meta {
            font-size: 0.9em;
            color: #6c757d;
        }

        .server-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            margin-left: 10px;
        }

        .schedule-section {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .schedule-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .schedule-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .datetime-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .datetime-input input {
            flex: 1;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }

        .close-modal {
            float: right;
            font-size: 1.5em;
            cursor: pointer;
            color: #999;
        }

        .close-modal:hover {
            color: #333;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 15px 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            align-items: center;
            z-index: 2000;
        }

        .toast.show {
            display: flex;
        }

        .toast.success {
            border-left: 5px solid #28a745;
        }

        .toast.error {
            border-left: 5px solid #dc3545;
        }

        .toast-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ „Éû„É´„ÉÅ„Çµ„Éº„Éê„ÉºFTPÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†</h1>
        
        <div class="main-grid">
            <!-- „Çµ„Éº„Éê„ÉºÁÆ°ÁêÜ„Çµ„Ç§„Éâ„Éê„Éº -->
            <div class="sidebar">
                <h2 style="margin-bottom: 20px;">üì° „Çµ„Éº„Éê„ÉºË®≠ÂÆö</h2>
                
                <div class="server-list" id="serverList">
                    <!-- „Çµ„Éº„Éê„Éº„É™„Çπ„Éà„ÅØJavaScript„ÅßÂãïÁöÑ„Å´ÁîüÊàê -->
                </div>
                
                <button class="add-server-btn" onclick="showServerForm()">
                    ‚ûï Êñ∞„Åó„ÅÑ„Çµ„Éº„Éê„Éº„ÇíËøΩÂä†
                </button>
                
                <div class="server-form" id="serverForm">
                    <h3 style="margin-bottom: 15px;">„Çµ„Éº„Éê„ÉºË®≠ÂÆö</h3>
                    
                    <div class="form-group">
                        <label>„Çµ„Éº„Éê„ÉºÂêç</label>
                        <input type="text" id="serverName" placeholder="‰æã: Ê•ΩÂ§©„É°„Ç§„É≥„Çµ„Éº„Éê„Éº">
                    </div>
                    
                    <div class="form-group">
                        <label>„Éõ„Çπ„Éà</label>
                        <input type="text" id="serverHost" placeholder="‰æã: upload.rakuten.ne.jp">
                    </div>
                    
                    <div class="form-group">
                        <label>„Éó„É≠„Éà„Ç≥„É´</label>
                        <select id="serverProtocol">
                            <option value="sftp">SFTP</option>
                            <option value="ftp">FTP</option>
                            <option value="ftps">FTPS</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>„Éù„Éº„Éà</label>
                        <input type="number" id="serverPort" value="22">
                    </div>
                    
                    <div class="form-group">
                        <label>„É¶„Éº„Ç∂„ÉºÂêç</label>
                        <input type="text" id="serverUsername">
                    </div>
                    
                    <div class="form-group">
                        <label>„Éë„Çπ„ÉØ„Éº„Éâ</label>
                        <input type="password" id="serverPassword">
                    </div>
                    
                    <div class="form-group">
                        <label>„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Éá„Ç£„É¨„ÇØ„Éà„É™</label>
                        <input type="text" id="serverDirectory" placeholder="‰æã: /cabinet/images/">
                    </div>
                    
                    <div class="file-type-section">
                        <h4 style="margin-bottom: 10px;">üìÅ ÂØæÂøú„Éï„Ç°„Ç§„É´„Çø„Ç§„Éó</h4>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="supportCsv" checked>
                            <label for="supportCsv">CSV „Éï„Ç°„Ç§„É´ÔºàÂïÜÂìÅ„Éá„Éº„ÇøÊõ¥Êñ∞Ôºâ</label>
                        </div>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="supportHtml" checked>
                            <label for="supportHtml">HTML „Éï„Ç°„Ç§„É´Ôºà„Éö„Éº„Ç∏Êõ¥Êñ∞Ôºâ</label>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="saveServer()">‰øùÂ≠ò</button>
                        <button class="btn btn-danger" onclick="hideServerForm()">„Ç≠„É£„É≥„Çª„É´</button>
                    </div>
                </div>
            </div>
            
            <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
            <div class="content">
                <div id="noServerMessage" style="text-align: center; padding: 50px; color: #6c757d;">
                    <div style="font-size: 4em; margin-bottom: 20px;">üì°</div>
                    <h2>„Çµ„Éº„Éê„Éº„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</h2>
                    <p>Â∑¶ÂÅ¥„ÅÆ„Çµ„Éº„Éê„Éº„É™„Çπ„Éà„Åã„ÇâÊé•Á∂ö„Åô„Çã„Çµ„Éº„Éê„Éº„ÇíÈÅ∏Êäû„Åô„Çã„Åã„ÄÅ<br>Êñ∞„Åó„ÅÑ„Çµ„Éº„Éê„Éº„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
                
                <div id="serverContent" style="display: none;">
                    <h2 id="selectedServerName" style="margin-bottom: 20px;">„Çµ„Éº„Éê„ÉºÂêç</h2>
                    
                    <!-- „Éï„Ç°„Ç§„É´„Çø„Ç§„ÉóÂà•„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="file-type-section">
                        <div class="file-type-header">
                            <div class="file-type-icon csv-icon">üìä</div>
                            <div>
                                <div class="file-type-title">CSV „Éï„Ç°„Ç§„É´</div>
                                <div style="font-size: 0.9em; color: #6c757d;">ÂïÜÂìÅ„Éá„Éº„Çø„ÅÆ‰∏ÄÊã¨Êõ¥Êñ∞</div>
                            </div>
                        </div>
                        
                        <div class="upload-area" id="csvUploadArea" ondrop="handleDrop(event, 'csv')" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                            <div class="upload-icon">üì§</div>
                            <div>CSV„Éï„Ç°„Ç§„É´„Çí„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó</div>
                            <div style="margin-top: 10px;">
                                <input type="file" id="csvFileInput" accept=".csv" multiple style="display: none;" onchange="handleFileSelect(event, 'csv')">
                                <button class="btn btn-primary" onclick="document.getElementById('csvFileInput').click()">„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</button>
                            </div>
                        </div>
                        
                        <div class="schedule-section">
                            <div class="schedule-header">
                                <div class="schedule-icon">‚è∞</div>
                                <div>
                                    <strong>„Çπ„Ç±„Ç∏„É•„Éº„É´Ë®≠ÂÆö</strong>
                                    <div style="font-size: 0.9em; color: #856404;">„Éá„Éï„Ç©„É´„Éà: ‰∏ÄÂõûÈôê„Çä„ÅÆ„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ</div>
                                </div>
                            </div>
                            
                            <div class="datetime-input">
                                <input type="date" id="csvDate">
                                <input type="time" id="csvTime">
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="csvBatch">
                                <label for="csvBatch">Ë§áÊï∞„Éï„Ç°„Ç§„É´„Çí„Åæ„Å®„ÇÅ„Å¶„Çπ„Ç±„Ç∏„É•„Éº„É´</label>
                            </div>
                        </div>
                        
                        <div class="file-list" id="csvFileList">
                            <!-- CSV„Éï„Ç°„Ç§„É´„É™„Çπ„Éà -->
                        </div>
                    </div>
                    
                    <div class="file-type-section">
                        <div class="file-type-header">
                            <div class="file-type-icon html-icon">üåê</div>
                            <div>
                                <div class="file-type-title">HTML „Éï„Ç°„Ç§„É´</div>
                                <div style="font-size: 0.9em; color: #6c757d;">„Ç¶„Çß„Éñ„Éö„Éº„Ç∏„ÅÆÊõ¥Êñ∞</div>
                            </div>
                        </div>
                        
                        <div class="upload-area" id="htmlUploadArea" ondrop="handleDrop(event, 'html')" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                            <div class="upload-icon">üì§</div>
                            <div>HTML„Éï„Ç°„Ç§„É´„Çí„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó</div>
                            <div style="margin-top: 10px;">
                                <input type="file" id="htmlFileInput" accept=".html,.htm" multiple style="display: none;" onchange="handleFileSelect(event, 'html')">
                                <button class="btn btn-primary" onclick="document.getElementById('htmlFileInput').click()">„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</button>
                            </div>
                        </div>
                        
                        <div class="schedule-section" style="background: #d1ecf1; border-color: #17a2b8;">
                            <div class="schedule-header">
                                <div class="schedule-icon">‚ö°</div>
                                <div>
                                    <strong>„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâË®≠ÂÆö</strong>
                                    <div style="font-size: 0.9em; color: #0c5460;">„Éá„Éï„Ç©„É´„Éà: Âç≥ÊôÇ„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ</div>
                                </div>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="htmlSchedule">
                                <label for="htmlSchedule">„Çπ„Ç±„Ç∏„É•„Éº„É´Ë®≠ÂÆö„ÇíÊúâÂäπ„Å´„Åô„Çã</label>
                            </div>
                            
                            <div class="datetime-input" id="htmlScheduleInputs" style="display: none;">
                                <input type="date" id="htmlDate">
                                <input type="time" id="htmlTime">
                            </div>
                        </div>
                        
                        <div class="file-list" id="htmlFileList">
                            <!-- HTML„Éï„Ç°„Ç§„É´„É™„Çπ„Éà -->
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-success" onclick="uploadFiles()">
                            üöÄ „Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂÆüË°å
                        </button>
                        <button class="btn btn-primary" onclick="testConnection()">
                            üîå Êé•Á∂ö„ÉÜ„Çπ„Éà
                        </button>
                        <button class="btn btn-danger" onclick="clearFiles()">
                            üóëÔ∏è „ÇØ„É™„Ç¢
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- „Éà„Éº„Çπ„ÉàÈÄöÁü• -->
    <div class="toast" id="toast">
        <div class="toast-icon" id="toastIcon"></div>
        <div id="toastMessage"></div>
    </div>
    
    <script>
        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let servers = [];
        let selectedServer = null;
        let csvFiles = [];
        let htmlFiles = [];
        
        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            loadServers();
            setupEventListeners();
        });
        
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö
        function setupEventListeners() {
            document.getElementById('htmlSchedule').addEventListener('change', (e) => {
                document.getElementById('htmlScheduleInputs').style.display = 
                    e.target.checked ? 'flex' : 'none';
            });
        }
        
        // „Çµ„Éº„Éê„Éº„É™„Çπ„Éà„ÅÆË™≠„ÅøËæº„Åø
        function loadServers() {
            const savedServers = localStorage.getItem('ftpServers');
            if (savedServers) {
                servers = JSON.parse(savedServers);
                renderServerList();
            }
        }
        
        // „Çµ„Éº„Éê„Éº„É™„Çπ„Éà„ÅÆÊèèÁîª
        function renderServerList() {
            const serverList = document.getElementById('serverList');
            serverList.innerHTML = '';
            
            servers.forEach((server, index) => {
                const serverItem = document.createElement('div');
                serverItem.className = 'server-item';
                serverItem.onclick = () => selectServer(index);
                
                // „Éï„Ç°„Ç§„É´„Çø„Ç§„Éó„Ç¢„Ç§„Ç≥„É≥
                let fileTypeIcons = '';
                if (server.supportCsv) fileTypeIcons += 'üìä ';
                if (server.supportHtml) fileTypeIcons += 'üåê ';
                
                serverItem.innerHTML = `
                    <div class="server-status ${server.connected ? 'connected' : ''}"></div>
                    <div class="server-name">${server.name}</div>
                    <div class="server-info">
                        ${server.host}:${server.port} (${server.protocol.toUpperCase()})<br>
                        ÂØæÂøú: ${fileTypeIcons}
                    </div>
                `;
                
                serverList.appendChild(serverItem);
            });
        }
        
        // „Çµ„Éº„Éê„ÉºÈÅ∏Êäû
        function selectServer(index) {
            selectedServer = servers[index];
            
            // „Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÅÆÊõ¥Êñ∞
            document.querySelectorAll('.server-item').forEach((item, i) => {
                if (i === index) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅÆË°®Á§∫
            document.getElementById('noServerMessage').style.display = 'none';
            document.getElementById('serverContent').style.display = 'block';
            document.getElementById('selectedServerName').textContent = selectedServer.name;
            
            // „Éï„Ç°„Ç§„É´„Çø„Ç§„Éó„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆË°®Á§∫/ÈùûË°®Á§∫
            const csvSection = document.querySelector('.file-type-section:nth-of-type(1)');
            const htmlSection = document.querySelector('.file-type-section:nth-of-type(2)');
            
            if (csvSection && selectedServer.supportCsv !== undefined) {
                csvSection.style.display = selectedServer.supportCsv ? 'block' : 'none';
            }
            if (htmlSection && selectedServer.supportHtml !== undefined) {
                htmlSection.style.display = selectedServer.supportHtml ? 'block' : 'none';
            }
        }
        
        // „Çµ„Éº„Éê„Éº„Éï„Ç©„Éº„É†„ÅÆË°®Á§∫
        function showServerForm() {
            document.getElementById('serverForm').classList.add('active');
        }
        
        // „Çµ„Éº„Éê„Éº„Éï„Ç©„Éº„É†„ÅÆÈùûË°®Á§∫
        function hideServerForm() {
            document.getElementById('serverForm').classList.remove('active');
            clearServerForm();
        }
        
        // „Çµ„Éº„Éê„Éº„Éï„Ç©„Éº„É†„ÅÆ„ÇØ„É™„Ç¢
        function clearServerForm() {
            document.getElementById('serverName').value = '';
            document.getElementById('serverHost').value = '';
            document.getElementById('serverProtocol').value = 'sftp';
            document.getElementById('serverPort').value = '22';
            document.getElementById('serverUsername').value = '';
            document.getElementById('serverPassword').value = '';
            document.getElementById('serverDirectory').value = '';
            document.getElementById('supportCsv').checked = true;
            document.getElementById('supportHtml').checked = true;
        }
        
        // „Çµ„Éº„Éê„Éº‰øùÂ≠ò
        function saveServer() {
            const server = {
                name: document.getElementById('serverName').value,
                host: document.getElementById('serverHost').value,
                protocol: document.getElementById('serverProtocol').value,
                port: document.getElementById('serverPort').value,
                username: document.getElementById('serverUsername').value,
                password: document.getElementById('serverPassword').value,
                directory: document.getElementById('serverDirectory').value,
                supportCsv: document.getElementById('supportCsv').checked,
                supportHtml: document.getElementById('supportHtml').checked,
                connected: false
            };
            
            if (!server.name || !server.host || !server.username) {
                showToast('ÂøÖÈ†àÈ†ÖÁõÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            servers.push(server);
            localStorage.setItem('ftpServers', JSON.stringify(servers));
            renderServerList();
            hideServerForm();
            showToast('„Çµ„Éº„Éê„Éº„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü', 'success');
        }
        
        // „Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Éè„É≥„Éâ„É©„Éº
        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('dragover');
        }
        
        function handleDragLeave(event) {
            event.currentTarget.classList.remove('dragover');
        }
        
        function handleDrop(event, fileType) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            
            const files = Array.from(event.dataTransfer.files);
            processFiles(files, fileType);
        }
        
        // „Éï„Ç°„Ç§„É´ÈÅ∏Êäû„Éè„É≥„Éâ„É©„Éº
        function handleFileSelect(event, fileType) {
            const files = Array.from(event.target.files);
            processFiles(files, fileType);
        }
        
        // „Éï„Ç°„Ç§„É´Âá¶ÁêÜ
        function processFiles(files, fileType) {
            if (!selectedServer) {
                showToast('„Çµ„Éº„Éê„Éº„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            files.forEach(file => {
                const fileObj = {
                    name: file.name,
                    size: file.size,
                    type: fileType,
                    server: selectedServer.name,
                    file: file
                };
                
                if (fileType === 'csv') {
                    csvFiles.push(fileObj);
                } else {
                    htmlFiles.push(fileObj);
                }
            });
            
            renderFileList(fileType);
            showToast(`${files.length}ÂÄã„ÅÆ„Éï„Ç°„Ç§„É´„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü`, 'success');
        }
        
        // „Éï„Ç°„Ç§„É´„É™„Çπ„Éà„ÅÆÊèèÁîª
        function renderFileList(fileType) {
            const listId = fileType === 'csv' ? 'csvFileList' : 'htmlFileList';
            const fileList = document.getElementById(listId);
            const files = fileType === 'csv' ? csvFiles : htmlFiles;
            
            fileList.innerHTML = '';
            
            files.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                const iconColor = fileType === 'csv' ? '#28a745' : '#fd7e14';
                const icon = fileType === 'csv' ? 'üìä' : 'üåê';
                
                fileItem.innerHTML = `
                    <div class="file-info">
                        <div class="file-icon" style="background: ${iconColor}; color: white;">
                            ${icon}
                        </div>
                        <div class="file-details">
                            <div class="file-name">${file.name}</div>
                            <div class="file-meta">
                                ${formatFileSize(file.size)}
                                <span class="server-badge">${file.server}</span>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-danger" style="padding: 5px 10px;" onclick="removeFile('${fileType}', ${index})">
                        ÂâäÈô§
                    </button>
                `;
                
                fileList.appendChild(fileItem);
            });
        }
        
        // „Éï„Ç°„Ç§„É´ÂâäÈô§
        function removeFile(fileType, index) {
            if (fileType === 'csv') {
                csvFiles.splice(index, 1);
            } else {
                htmlFiles.splice(index, 1);
            }
            renderFileList(fileType);
        }
        
        // „Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅÆ„Éï„Ç©„Éº„Éû„ÉÉ„Éà
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        // Êé•Á∂ö„ÉÜ„Çπ„Éà
        async function testConnection() {
            if (!selectedServer) {
                showToast('„Çµ„Éº„Éê„Éº„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8080/api/test-connection', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        host: selectedServer.host,
                        port: parseInt(selectedServer.port),
                        username: selectedServer.username,
                        password: selectedServer.password,
                        protocol: selectedServer.protocol
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    selectedServer.connected = true;
                    servers[servers.indexOf(selectedServer)] = selectedServer;
                    localStorage.setItem('ftpServers', JSON.stringify(servers));
                    renderServerList();
                    showToast('Êé•Á∂öÊàêÂäüÔºÅ', 'success');
                } else {
                    showToast('Êé•Á∂öÂ§±Êïó: ' + result.message, 'error');
                }
            } catch (error) {
                showToast('Êé•Á∂ö„Ç®„É©„Éº: ' + error.message, 'error');
            }
        }
        
        // „Éï„Ç°„Ç§„É´„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ
        async function uploadFiles() {
            if (!selectedServer) {
                showToast('„Çµ„Éº„Éê„Éº„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            if (csvFiles.length === 0 && htmlFiles.length === 0) {
                showToast('„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åô„Çã„Éï„Ç°„Ç§„É´„Åå„ÅÇ„Çä„Åæ„Åõ„Çì', 'error');
                return;
            }
            
            const formData = new FormData();
            
            // „Çµ„Éº„Éê„ÉºÊÉÖÂ†±
            formData.append('server', JSON.stringify({
                host: selectedServer.host,
                port: parseInt(selectedServer.port),
                username: selectedServer.username,
                password: selectedServer.password,
                protocol: selectedServer.protocol,
                directory: selectedServer.directory
            }));
            
            // CSV„Éï„Ç°„Ç§„É´
            csvFiles.forEach(file => {
                formData.append('files', file.file);
                formData.append(`schedule_${file.name}`, JSON.stringify({
                    date: document.getElementById('csvDate').value,
                    time: document.getElementById('csvTime').value,
                    batch: document.getElementById('csvBatch').checked
                }));
            });
            
            // HTML„Éï„Ç°„Ç§„É´
            htmlFiles.forEach(file => {
                formData.append('files', file.file);
                if (document.getElementById('htmlSchedule').checked) {
                    formData.append(`schedule_${file.name}`, JSON.stringify({
                        date: document.getElementById('htmlDate').value,
                        time: document.getElementById('htmlTime').value
                    }));
                }
            });
            
            try {
                const response = await fetch('http://localhost:8080/api/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showToast('„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊàêÂäüÔºÅ', 'success');
                    clearFiles();
                } else {
                    showToast('„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂ§±Êïó: ' + result.message, 'error');
                }
            } catch (error) {
                showToast('„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Ç®„É©„Éº: ' + error.message, 'error');
            }
        }
        
        // „Éï„Ç°„Ç§„É´„ÇØ„É™„Ç¢
        function clearFiles() {
            csvFiles = [];
            htmlFiles = [];
            document.getElementById('csvFileList').innerHTML = '';
            document.getElementById('htmlFileList').innerHTML = '';
            document.getElementById('csvFileInput').value = '';
            document.getElementById('htmlFileInput').value = '';
            showToast('„Éï„Ç°„Ç§„É´„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„Åü', 'success');
        }
        
        // „Éà„Éº„Çπ„ÉàÈÄöÁü•
        function showToast(message, type) {
            const toast = document.getElementById('toast');
            const toastIcon = document.getElementById('toastIcon');
            const toastMessage = document.getElementById('toastMessage');
            
            toast.className = `toast show ${type}`;
            toastIcon.textContent = type === 'success' ? '‚úÖ' : '‚ùå';
            toastMessage.textContent = message;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>